<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/pom.xml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/pom.xml" />
              <option name="originalContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;&#9;xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;&#9;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;&#9;&lt;parent&gt;&#10;&#9;&#9;&lt;groupId&gt;org.example&lt;/groupId&gt;&#10;&#9;&#9;&lt;artifactId&gt;TFG_BACK&lt;/artifactId&gt;&#10;&#9;&#9;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&#10;&#9;&lt;/parent&gt;&#10;&#10;&#9;&lt;groupId&gt;com.evs&lt;/groupId&gt;&#10;&#9;&lt;artifactId&gt;MicroserviceRegattaApi&lt;/artifactId&gt;&#10;&#9;&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;&#9;&lt;name&gt;MicroserviceRegattaApi&lt;/name&gt;&#10;&#9;&lt;description&gt;Demo project for Spring Boot&lt;/description&gt;&#10;&#9;&lt;url/&gt;&#10;&#9;&lt;licenses&gt;&#10;&#9;&#9;&lt;license/&gt;&#10;&#9;&lt;/licenses&gt;&#10;&#9;&lt;developers&gt;&#10;&#9;&#9;&lt;developer/&gt;&#10;&#9;&lt;/developers&gt;&#10;&#9;&lt;scm&gt;&#10;&#9;&#9;&lt;connection/&gt;&#10;&#9;&#9;&lt;developerConnection/&gt;&#10;&#9;&#9;&lt;tag/&gt;&#10;&#9;&#9;&lt;url/&gt;&#10;&#9;&lt;/scm&gt;&#10;&#9;&lt;properties&gt;&#10;&#9;&#9;&lt;java.version&gt;17&lt;/java.version&gt;&#10;&#9;&lt;/properties&gt;&#10;&#9;&lt;dependencies&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;scope&gt;test&lt;/scope&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#9;&lt;/dependencies&gt;&#10;&#10;&#9;&lt;build&gt;&#10;&#9;&#9;&lt;plugins&gt;&#10;&#9;&#9;&#9;&lt;plugin&gt;&#10;&#9;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;/plugin&gt;&#10;&#9;&#9;&lt;/plugins&gt;&#10;&#9;&lt;/build&gt;&#10;&#10;&lt;/project&gt;&#10;" />
              <option name="updatedContent" value="&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#10;&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#10;&#9;xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;&#10;&#9;&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;&#10;&#9;&lt;parent&gt;&#10;&#9;&#9;&lt;groupId&gt;org.example&lt;/groupId&gt;&#10;&#9;&#9;&lt;artifactId&gt;TFG_BACK&lt;/artifactId&gt;&#10;&#9;&#9;&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;&#10;&#9;&lt;/parent&gt;&#10;&#10;&#9;&lt;groupId&gt;com.evs&lt;/groupId&gt;&#10;&#9;&lt;artifactId&gt;MicroserviceRegattaApi&lt;/artifactId&gt;&#10;&#9;&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;&#10;&#9;&lt;name&gt;MicroserviceRegattaApi&lt;/name&gt;&#10;&#9;&lt;description&gt;Microservicio de gestión de regatas de catamaranes&lt;/description&gt;&#10;&#9;&#10;&#9;&lt;properties&gt;&#10;&#9;&#9;&lt;java.version&gt;17&lt;/java.version&gt;&#10;&#9;&#9;&lt;spring-cloud.version&gt;2023.0.3&lt;/spring-cloud.version&gt;&#10;&#9;&lt;/properties&gt;&#10;&#9;&#10;&#9;&lt;dependencies&gt;&#10;&#9;&#9;&lt;!-- Spring Web --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- Spring Data JPA --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- Eureka Client --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- Kafka --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.kafka&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-kafka&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- Security --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- JWT --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;jjwt-api&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;jjwt-impl&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;scope&gt;runtime&lt;/scope&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;jjwt-jackson&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;scope&gt;runtime&lt;/scope&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- Validation --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;!-- PostgreSQL --&gt;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.postgresql&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;postgresql&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;scope&gt;runtime&lt;/scope&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#10;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;scope&gt;test&lt;/scope&gt;&#10;&#9;&#9;&lt;/dependency&gt;&#10;&#9;&lt;/dependencies&gt;&#10;&#10;&#9;&lt;dependencyManagement&gt;&#10;&#9;&#9;&lt;dependencies&gt;&#10;&#9;&#9;&#9;&lt;dependency&gt;&#10;&#9;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;&#10;&#9;&#9;&#9;&#9;&lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&#9;&lt;version&gt;${spring-cloud.version}&lt;/version&gt;&#10;&#9;&#9;&#9;&#9;&lt;type&gt;pom&lt;/type&gt;&#10;&#9;&#9;&#9;&#9;&lt;scope&gt;import&lt;/scope&gt;&#10;&#9;&#9;&#9;&lt;/dependency&gt;&#10;&#9;&#9;&lt;/dependencies&gt;&#10;&#9;&lt;/dependencyManagement&gt;&#10;&#10;&#9;&lt;build&gt;&#10;&#9;&#9;&lt;plugins&gt;&#10;&#9;&#9;&#9;&lt;plugin&gt;&#10;&#9;&#9;&#9;&#9;&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;&#10;&#9;&#9;&#9;&#9;&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;&#10;&#9;&#9;&#9;&lt;/plugin&gt;&#10;&#9;&#9;&lt;/plugins&gt;&#10;&#9;&lt;/build&gt;&#10;&#10;&lt;/project&gt;&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/BoatController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/BoatController.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Controller;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Boat;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IBoatService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/boats&quot;)&#10;@RequiredArgsConstructor&#10;public class BoatController {&#10;&#10;    private final IBoatService boatService;&#10;&#10;    @PostMapping&#10;    public ResponseEntity&lt;Boat&gt; create(@RequestBody Boat boat) {&#10;        return ResponseEntity.status(HttpStatus.CREATED).body(boatService.create(boat));&#10;    }&#10;&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Boat&gt; update(@PathVariable Long id, @RequestBody Boat boat) {&#10;        return ResponseEntity.ok(boatService.update(id, boat));&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Boat&gt; findById(@PathVariable Long id) {&#10;        return ResponseEntity.ok(boatService.findById(id));&#10;    }&#10;&#10;    @GetMapping(&quot;/sail/{sailNumber}&quot;)&#10;    public ResponseEntity&lt;Boat&gt; findBySailNumber(@PathVariable String sailNumber) {&#10;        return ResponseEntity.ok(boatService.findBySailNumber(sailNumber));&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;Boat&gt;&gt; findAll() {&#10;        return ResponseEntity.ok(boatService.findAll());&#10;    }&#10;&#10;    @GetMapping(&quot;/owner/{ownerId}&quot;)&#10;    public ResponseEntity&lt;List&lt;Boat&gt;&gt; findByOwner(@PathVariable Long ownerId) {&#10;        return ResponseEntity.ok(boatService.findByOwner(ownerId));&#10;    }&#10;&#10;    @GetMapping(&quot;/class/{boatClass}&quot;)&#10;    public ResponseEntity&lt;List&lt;Boat&gt;&gt; findByClass(@PathVariable String boatClass) {&#10;        return ResponseEntity.ok(boatService.findByClass(boatClass));&#10;    }&#10;&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Void&gt; delete(@PathVariable Long id) {&#10;        boatService.delete(id);&#10;        return ResponseEntity.noContent().build();&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/ParticipantController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/ParticipantController.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Controller;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IParticipantService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/participants&quot;)&#10;@RequiredArgsConstructor&#10;public class ParticipantController {&#10;&#10;    private final IParticipantService participantService;&#10;&#10;    @PostMapping(&quot;/register&quot;)&#10;    public ResponseEntity&lt;RegattaParticipant&gt; register(&#10;            @RequestParam Long regattaId,&#10;            @RequestParam Long boatId,&#10;            @RequestParam Long skipperId,&#10;            @RequestParam(required = false) List&lt;Long&gt; crewIds,&#10;            @RequestParam(required = false) List&lt;String&gt; crewNames) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(participantService.register(regattaId, boatId, skipperId, crewIds, crewNames));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/confirm&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RegattaParticipant&gt; confirm(@PathVariable Long id) {&#10;        return ResponseEntity.ok(participantService.confirm(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/withdraw&quot;)&#10;    public ResponseEntity&lt;RegattaParticipant&gt; withdraw(@PathVariable Long id) {&#10;        return ResponseEntity.ok(participantService.withdraw(id));&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;RegattaParticipant&gt; findById(@PathVariable Long id) {&#10;        return ResponseEntity.ok(participantService.findById(id));&#10;    }&#10;&#10;    @GetMapping(&quot;/regatta/{regattaId}&quot;)&#10;    public ResponseEntity&lt;List&lt;RegattaParticipant&gt;&gt; findByRegatta(@PathVariable Long regattaId) {&#10;        return ResponseEntity.ok(participantService.findByRegatta(regattaId));&#10;    }&#10;&#10;    @GetMapping(&quot;/skipper/{skipperId}&quot;)&#10;    public ResponseEntity&lt;List&lt;RegattaParticipant&gt;&gt; findBySkipper(@PathVariable Long skipperId) {&#10;        return ResponseEntity.ok(participantService.findBySkipper(skipperId));&#10;    }&#10;&#10;    @GetMapping(&quot;/regatta/{regattaId}/classification&quot;)&#10;    public ResponseEntity&lt;List&lt;RegattaParticipant&gt;&gt; getClassification(@PathVariable Long regattaId) {&#10;        return ResponseEntity.ok(participantService.getClassification(regattaId));&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/RaceController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/RaceController.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Controller;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Race;&#10;import com.evs.MicroserviceRegattaApi.Entities.RaceResult;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRaceResultService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRaceService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/races&quot;)&#10;@RequiredArgsConstructor&#10;public class RaceController {&#10;&#10;    private final IRaceService raceService;&#10;    private final IRaceResultService resultService;&#10;&#10;    @PostMapping&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Race&gt; create(@RequestParam Long regattaId, @RequestParam Integer raceNumber) {&#10;        return ResponseEntity.status(HttpStatus.CREATED).body(raceService.create(regattaId, raceNumber));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/start&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Race&gt; start(&#10;            @PathVariable Long id,&#10;            @RequestParam Integer windDirection,&#10;            @RequestParam Double windSpeed) {&#10;        return ResponseEntity.ok(raceService.start(id, windDirection, windSpeed));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/finish&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Race&gt; finish(@PathVariable Long id) {&#10;        return ResponseEntity.ok(raceService.finish(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/abandon&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Race&gt; abandon(@PathVariable Long id, @RequestParam String reason) {&#10;        return ResponseEntity.ok(raceService.abandon(id, reason));&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Race&gt; findById(@PathVariable Long id) {&#10;        return ResponseEntity.ok(raceService.findById(id));&#10;    }&#10;&#10;    @GetMapping(&quot;/regatta/{regattaId}&quot;)&#10;    public ResponseEntity&lt;List&lt;Race&gt;&gt; findByRegatta(@PathVariable Long regattaId) {&#10;        return ResponseEntity.ok(raceService.findByRegatta(regattaId));&#10;    }&#10;&#10;    // === Results Endpoints ===&#10;&#10;    @PostMapping(&quot;/{raceId}/results/finish&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RaceResult&gt; recordFinish(&#10;            @PathVariable Long raceId,&#10;            @RequestParam Long participantId,&#10;            @RequestParam Long elapsedSeconds) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(resultService.recordFinish(raceId, participantId, elapsedSeconds));&#10;    }&#10;&#10;    @PostMapping(&quot;/{raceId}/results/dnf&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RaceResult&gt; recordDNF(&#10;            @PathVariable Long raceId,&#10;            @RequestParam Long participantId,&#10;            @RequestParam(required = false) String reason) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(resultService.recordDNF(raceId, participantId, reason));&#10;    }&#10;&#10;    @PostMapping(&quot;/{raceId}/results/dns&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RaceResult&gt; recordDNS(&#10;            @PathVariable Long raceId,&#10;            @RequestParam Long participantId,&#10;            @RequestParam(required = false) String reason) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(resultService.recordDNS(raceId, participantId, reason));&#10;    }&#10;&#10;    @PostMapping(&quot;/{raceId}/results/dsq&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RaceResult&gt; recordDSQ(&#10;            @PathVariable Long raceId,&#10;            @RequestParam Long participantId,&#10;            @RequestParam String reason) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(resultService.recordDSQ(raceId, participantId, reason));&#10;    }&#10;&#10;    @PostMapping(&quot;/{raceId}/results/ocs&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;RaceResult&gt; recordOCS(&#10;            @PathVariable Long raceId,&#10;            @RequestParam Long participantId) {&#10;        return ResponseEntity.status(HttpStatus.CREATED)&#10;                .body(resultService.recordOCS(raceId, participantId));&#10;    }&#10;&#10;    @GetMapping(&quot;/{raceId}/results&quot;)&#10;    public ResponseEntity&lt;List&lt;RaceResult&gt;&gt; getResults(@PathVariable Long raceId) {&#10;        return ResponseEntity.ok(resultService.findByRace(raceId));&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/RegattaController.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Controller/RegattaController.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Controller;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRegattaService;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.security.access.prepost.PreAuthorize;&#10;import org.springframework.web.bind.annotation.*;&#10;&#10;import java.util.List;&#10;&#10;@RestController&#10;@RequestMapping(&quot;/api/regattas&quot;)&#10;@RequiredArgsConstructor&#10;public class RegattaController {&#10;&#10;    private final IRegattaService regattaService;&#10;&#10;    @PostMapping&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; create(@RequestBody Regatta regatta, @RequestParam Long createdBy) {&#10;        return ResponseEntity.status(HttpStatus.CREATED).body(regattaService.create(regatta, createdBy));&#10;    }&#10;&#10;    @PutMapping(&quot;/{id}&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; update(@PathVariable Long id, @RequestBody Regatta regatta) {&#10;        return ResponseEntity.ok(regattaService.update(id, regatta));&#10;    }&#10;&#10;    @GetMapping(&quot;/{id}&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; findById(@PathVariable Long id) {&#10;        return ResponseEntity.ok(regattaService.findById(id));&#10;    }&#10;&#10;    @GetMapping&#10;    public ResponseEntity&lt;List&lt;Regatta&gt;&gt; findAll() {&#10;        return ResponseEntity.ok(regattaService.findAll());&#10;    }&#10;&#10;    @GetMapping(&quot;/upcoming&quot;)&#10;    public ResponseEntity&lt;List&lt;Regatta&gt;&gt; findUpcoming() {&#10;        return ResponseEntity.ok(regattaService.findUpcoming());&#10;    }&#10;&#10;    @GetMapping(&quot;/status/{status}&quot;)&#10;    public ResponseEntity&lt;List&lt;Regatta&gt;&gt; findByStatus(@PathVariable String status) {&#10;        return ResponseEntity.ok(regattaService.findByStatus(status));&#10;    }&#10;&#10;    @DeleteMapping(&quot;/{id}&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Void&gt; delete(@PathVariable Long id) {&#10;        regattaService.delete(id);&#10;        return ResponseEntity.noContent().build();&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/open-registrations&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; openRegistrations(@PathVariable Long id) {&#10;        return ResponseEntity.ok(regattaService.openRegistrations(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/close-registrations&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; closeRegistrations(@PathVariable Long id) {&#10;        return ResponseEntity.ok(regattaService.closeRegistrations(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/start&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; start(@PathVariable Long id) {&#10;        return ResponseEntity.ok(regattaService.start(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/finish&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; finish(@PathVariable Long id) {&#10;        return ResponseEntity.ok(regattaService.finish(id));&#10;    }&#10;&#10;    @PostMapping(&quot;/{id}/staff&quot;)&#10;    @PreAuthorize(&quot;hasAnyRole('ADMIN', 'BOSS')&quot;)&#10;    public ResponseEntity&lt;Regatta&gt; assignStaff(@PathVariable Long id, @RequestBody List&lt;Long&gt; staffIds) {&#10;        return ResponseEntity.ok(regattaService.assignStaff(id, staffIds));&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Boat.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Boat.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Entities;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Builder;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.math.BigDecimal;&#10;&#10;/**&#10; * Barco inscrito en regatas con su rating para handicap&#10; */&#10;@Data&#10;@Entity&#10;@Builder&#10;@Table(name = &quot;boats&quot;)&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class Boat {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @Column(nullable = false)&#10;    private String name;&#10;&#10;    @Column(name = &quot;sail_number&quot;, nullable = false, unique = true)&#10;    private String sailNumber;&#10;&#10;    @Column(name = &quot;boat_class&quot;, nullable = false)&#10;    private String boatClass;&#10;&#10;    @Column(precision = 6, scale = 3)&#10;    private BigDecimal rating;&#10;&#10;    @Column(name = &quot;auto_rating&quot;)&#10;    private Boolean autoRating = true;&#10;&#10;    @Column(name = &quot;owner_id&quot;)&#10;    private Long ownerId;&#10;&#10;    @Column(precision = 5, scale = 2)&#10;    private BigDecimal length;&#10;&#10;    @Column(precision = 5, scale = 2)&#10;    private BigDecimal beam;&#10;&#10;    @Column(name = &quot;sail_area&quot;, precision = 6, scale = 2)&#10;    private BigDecimal sailArea;&#10;&#10;    @Column(name = &quot;build_year&quot;)&#10;    private Integer buildYear;&#10;&#10;    @Column(length = 500)&#10;    private String notes;&#10;&#10;    @Column(name = &quot;photo_id&quot;)&#10;    private String photoId;&#10;&#10;    @PrePersist&#10;    @PreUpdate&#10;    public void calculateAutoRating() {&#10;        if (autoRating &amp;&amp; boatClass != null) {&#10;            this.rating = getDefaultRatingForClass(boatClass);&#10;        }&#10;    }&#10;&#10;    private BigDecimal getDefaultRatingForClass(String boatClass) {&#10;        return switch (boatClass.toUpperCase()) {&#10;            case &quot;HOBIE_16&quot; -&gt; new BigDecimal(&quot;0.950&quot;);&#10;            case &quot;CATAMARAN_F18&quot; -&gt; new BigDecimal(&quot;1.100&quot;);&#10;            case &quot;NACRA_17&quot; -&gt; new BigDecimal(&quot;1.050&quot;);&#10;            case &quot;NACRA_15&quot; -&gt; new BigDecimal(&quot;0.980&quot;);&#10;            case &quot;DART_16&quot; -&gt; new BigDecimal(&quot;0.900&quot;);&#10;            case &quot;TORNADO&quot; -&gt; new BigDecimal(&quot;1.150&quot;);&#10;            default -&gt; new BigDecimal(&quot;1.000&quot;);&#10;        };&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Race.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Race.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Entities;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Builder;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.time.LocalDateTime;&#10;&#10;/**&#10; * Manga (carrera) dentro de una regata&#10; */&#10;@Data&#10;@Entity&#10;@Builder&#10;@Table(name = &quot;races&quot;)&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class Race {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;regatta_id&quot;, nullable = false)&#10;    private Regatta regatta;&#10;&#10;    @Column(name = &quot;race_number&quot;, nullable = false)&#10;    private Integer raceNumber;&#10;&#10;    @Column(name = &quot;start_time&quot;)&#10;    private LocalDateTime startTime;&#10;&#10;    // PLANIFICADA, SEÑAL_PREPARATORIA, EN_CURSO, FINALIZADA, ABANDONADA&#10;    @Column(nullable = false)&#10;    private String status = &quot;PLANIFICADA&quot;;&#10;&#10;    @Column(name = &quot;wind_direction&quot;)&#10;    private Integer windDirection;&#10;&#10;    @Column(name = &quot;wind_speed&quot;)&#10;    private Double windSpeed;&#10;&#10;    @Column(name = &quot;number_of_laps&quot;)&#10;    private Integer numberOfLaps = 1;&#10;&#10;    @Column(name = &quot;course_type&quot;)&#10;    private String courseType;&#10;&#10;    @Column(length = 1000)&#10;    private String notes;&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/RaceResult.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/RaceResult.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Entities;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Builder;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.math.BigDecimal;&#10;import java.time.LocalTime;&#10;&#10;/**&#10; * Resultado de un participante en una manga&#10; */&#10;@Data&#10;@Entity&#10;@Builder&#10;@Table(name = &quot;race_results&quot;)&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class RaceResult {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;race_id&quot;, nullable = false)&#10;    private Race race;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;participant_id&quot;, nullable = false)&#10;    private RegattaParticipant participant;&#10;&#10;    @Column(name = &quot;finish_time&quot;)&#10;    private LocalTime finishTime;&#10;&#10;    @Column(name = &quot;elapsed_seconds&quot;)&#10;    private Long elapsedSeconds;&#10;&#10;    @Column(name = &quot;corrected_seconds&quot;)&#10;    private Long correctedSeconds;&#10;&#10;    @Column(name = &quot;position&quot;)&#10;    private Integer position;&#10;&#10;    @Column(name = &quot;points&quot;)&#10;    private Integer points;&#10;&#10;    // FINISH, DNF, DNS, DSQ, OCS, BFD, UFD, RET&#10;    @Column(nullable = false)&#10;    private String status = &quot;FINISH&quot;;&#10;&#10;    @Column(name = &quot;penalty_points&quot;)&#10;    private Integer penaltyPoints = 0;&#10;&#10;    @Column(length = 500)&#10;    private String notes;&#10;&#10;    public void calculateCorrectedTime(BigDecimal rating) {&#10;        if (elapsedSeconds != null &amp;&amp; rating != null &amp;&amp; rating.compareTo(BigDecimal.ZERO) &gt; 0) {&#10;            BigDecimal corrected = new BigDecimal(elapsedSeconds).divide(rating, 0, java.math.RoundingMode.HALF_UP);&#10;            this.correctedSeconds = corrected.longValue();&#10;        }&#10;    }&#10;&#10;    public void assignPoints(int totalParticipants) {&#10;        this.points = switch (status.toUpperCase()) {&#10;            case &quot;FINISH&quot; -&gt; position != null ? position : totalParticipants + 1;&#10;            case &quot;DNF&quot;, &quot;RET&quot;, &quot;DNS&quot;, &quot;DSQ&quot;, &quot;OCS&quot;, &quot;BFD&quot;, &quot;UFD&quot; -&gt; totalParticipants + 1;&#10;            default -&gt; totalParticipants + 1;&#10;        };&#10;        this.points += penaltyPoints;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Regatta.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/Regatta.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Entities;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Builder;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;/**&#10; * Regata de catamaranes&#10; */&#10;@Data&#10;@Entity&#10;@Builder&#10;@Table(name = &quot;regattas&quot;)&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class Regatta {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @Column(nullable = false)&#10;    private String name;&#10;&#10;    @Column(length = 1000)&#10;    private String description;&#10;&#10;    @Column(name = &quot;event_date&quot;, nullable = false)&#10;    private LocalDate eventDate;&#10;&#10;    @Column(name = &quot;registration_deadline&quot;)&#10;    private LocalDate registrationDeadline;&#10;&#10;    private String location;&#10;&#10;    // Estado: PLANIFICADA, INSCRIPCIONES_ABIERTAS, INSCRIPCIONES_CERRADAS, EN_CURSO, FINALIZADA, CANCELADA&#10;    @Column(nullable = false)&#10;    private String status = &quot;PLANIFICADA&quot;;&#10;&#10;    @Column(name = &quot;max_participants&quot;)&#10;    private Integer maxParticipants;&#10;&#10;    @Column(name = &quot;registration_fee&quot;)&#10;    private Double registrationFee;&#10;&#10;    @Column(name = &quot;planned_races&quot;)&#10;    private Integer plannedRaces = 3;&#10;&#10;    @Column(name = &quot;created_by&quot;, nullable = false)&#10;    private Long createdBy;&#10;&#10;    @Column(name = &quot;created_at&quot;)&#10;    private LocalDateTime createdAt;&#10;&#10;    @Column(length = 2000)&#10;    private String notes;&#10;&#10;    @ElementCollection&#10;    @CollectionTable(name = &quot;regatta_staff&quot;, joinColumns = @JoinColumn(name = &quot;regatta_id&quot;))&#10;    @Column(name = &quot;teacher_id&quot;)&#10;    private List&lt;Long&gt; staffIds = new ArrayList&lt;&gt;();&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/RegattaParticipant.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Entities/RegattaParticipant.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Entities;&#10;&#10;import jakarta.persistence.*;&#10;import lombok.AllArgsConstructor;&#10;import lombok.Builder;&#10;import lombok.Data;&#10;import lombok.NoArgsConstructor;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;&#10;/**&#10; * Participante inscrito en una regata&#10; */&#10;@Data&#10;@Entity&#10;@Builder&#10;@Table(name = &quot;regatta_participants&quot;)&#10;@AllArgsConstructor&#10;@NoArgsConstructor&#10;public class RegattaParticipant {&#10;&#10;    @Id&#10;    @GeneratedValue(strategy = GenerationType.IDENTITY)&#10;    private Long id;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;regatta_id&quot;, nullable = false)&#10;    private Regatta regatta;&#10;&#10;    @ManyToOne(fetch = FetchType.LAZY)&#10;    @JoinColumn(name = &quot;boat_id&quot;, nullable = false)&#10;    private Boat boat;&#10;&#10;    @Column(name = &quot;skipper_id&quot;, nullable = false)&#10;    private Long skipperId;&#10;&#10;    @Column(name = &quot;skipper_name&quot;)&#10;    private String skipperName;&#10;&#10;    @ElementCollection&#10;    @CollectionTable(name = &quot;participant_crew&quot;, joinColumns = @JoinColumn(name = &quot;participant_id&quot;))&#10;    @Column(name = &quot;crew_member_id&quot;)&#10;    private List&lt;Long&gt; crewIds = new ArrayList&lt;&gt;();&#10;&#10;    @ElementCollection&#10;    @CollectionTable(name = &quot;participant_crew_names&quot;, joinColumns = @JoinColumn(name = &quot;participant_id&quot;))&#10;    @Column(name = &quot;crew_name&quot;)&#10;    private List&lt;String&gt; crewNames = new ArrayList&lt;&gt;();&#10;&#10;    @Column(name = &quot;registration_date&quot;)&#10;    private LocalDateTime registrationDate;&#10;&#10;    @Column(nullable = false)&#10;    private String status = &quot;INSCRITO&quot;;&#10;&#10;    @Column(name = &quot;fee_paid&quot;)&#10;    private Boolean feePaid = false;&#10;&#10;    @Column(name = &quot;payment_id&quot;)&#10;    private Long paymentId;&#10;&#10;    @Column(name = &quot;total_points&quot;)&#10;    private Integer totalPoints = 0;&#10;&#10;    @Column(name = &quot;final_position&quot;)&#10;    private Integer finalPosition;&#10;&#10;    @Column(length = 500)&#10;    private String notes;&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Kafka/KafkaConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Kafka/KafkaConfig.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Kafka;&#10;&#10;import org.apache.kafka.clients.admin.NewTopic;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.kafka.config.TopicBuilder;&#10;&#10;@Configuration&#10;public class KafkaConfig {&#10;&#10;    @Bean&#10;    public NewTopic regattaEventsTopic() {&#10;        return TopicBuilder.name(&quot;regatta-events&quot;)&#10;                .partitions(3)&#10;                .replicas(1)&#10;                .build();&#10;    }&#10;&#10;    @Bean&#10;    public NewTopic regattaRegistrationEventsTopic() {&#10;        return TopicBuilder.name(&quot;regatta-registration-events&quot;)&#10;                .partitions(3)&#10;                .replicas(1)&#10;                .build();&#10;    }&#10;&#10;    @Bean&#10;    public NewTopic raceEventsTopic() {&#10;        return TopicBuilder.name(&quot;race-events&quot;)&#10;                .partitions(3)&#10;                .replicas(1)&#10;                .build();&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/MicroserviceRegattaApiApplication.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/MicroserviceRegattaApiApplication.java" />
              <option name="originalContent" value="package com.evs.MicroserviceRegattaApi;&#10;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;&#10;@SpringBootApplication&#10;public class MicroserviceRegattaApiApplication {&#10;&#10;&#9;public static void main(String[] args) {&#10;&#9;&#9;SpringApplication.run(MicroserviceRegattaApiApplication.class, args);&#10;&#9;}&#10;&#10;}&#10;" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi;&#10;&#10;import org.springframework.boot.SpringApplication;&#10;import org.springframework.boot.autoconfigure.SpringBootApplication;&#10;import org.springframework.cloud.client.discovery.EnableDiscoveryClient;&#10;&#10;@EnableDiscoveryClient&#10;@SpringBootApplication&#10;public class MicroserviceRegattaApiApplication {&#10;&#10;&#9;public static void main(String[] args) {&#10;&#9;&#9;SpringApplication.run(MicroserviceRegattaApiApplication.class, args);&#10;&#9;}&#10;&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/BoatRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/BoatRepository.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Repository;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Boat;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import org.springframework.stereotype.Repository;&#10;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;@Repository&#10;public interface BoatRepository extends JpaRepository&lt;Boat, Long&gt; {&#10;&#10;    Optional&lt;Boat&gt; findBySailNumber(String sailNumber);&#10;&#10;    List&lt;Boat&gt; findByOwnerId(Long ownerId);&#10;&#10;    List&lt;Boat&gt; findByBoatClass(String boatClass);&#10;&#10;    boolean existsBySailNumber(String sailNumber);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RaceRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RaceRepository.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Repository;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Race;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import org.springframework.stereotype.Repository;&#10;&#10;import java.util.List;&#10;&#10;@Repository&#10;public interface RaceRepository extends JpaRepository&lt;Race, Long&gt; {&#10;&#10;    List&lt;Race&gt; findByRegattaIdOrderByRaceNumberAsc(Long regattaId);&#10;&#10;    List&lt;Race&gt; findByRegattaIdAndStatus(Long regattaId, String status);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RaceResultRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RaceResultRepository.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Repository;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RaceResult;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import org.springframework.data.jpa.repository.Query;&#10;import org.springframework.data.repository.query.Param;&#10;import org.springframework.stereotype.Repository;&#10;&#10;import java.util.List;&#10;&#10;@Repository&#10;public interface RaceResultRepository extends JpaRepository&lt;RaceResult, Long&gt; {&#10;&#10;    List&lt;RaceResult&gt; findByRaceIdOrderByPositionAsc(Long raceId);&#10;&#10;    List&lt;RaceResult&gt; findByParticipantId(Long participantId);&#10;&#10;    @Query(&quot;SELECT rr FROM RaceResult rr WHERE rr.race.id = :raceId ORDER BY rr.correctedSeconds ASC NULLS LAST&quot;)&#10;    List&lt;RaceResult&gt; findByRaceIdOrderByCorrectedTime(@Param(&quot;raceId&quot;) Long raceId);&#10;&#10;    @Query(&quot;SELECT SUM(rr.points) FROM RaceResult rr WHERE rr.participant.id = :participantId&quot;)&#10;    Integer sumPointsByParticipant(@Param(&quot;participantId&quot;) Long participantId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RegattaParticipantRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RegattaParticipantRepository.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Repository;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import org.springframework.data.jpa.repository.Query;&#10;import org.springframework.data.repository.query.Param;&#10;import org.springframework.stereotype.Repository;&#10;&#10;import java.util.List;&#10;import java.util.Optional;&#10;&#10;@Repository&#10;public interface RegattaParticipantRepository extends JpaRepository&lt;RegattaParticipant, Long&gt; {&#10;&#10;    List&lt;RegattaParticipant&gt; findByRegattaId(Long regattaId);&#10;&#10;    List&lt;RegattaParticipant&gt; findBySkipperId(Long skipperId);&#10;&#10;    List&lt;RegattaParticipant&gt; findByBoatId(Long boatId);&#10;&#10;    Optional&lt;RegattaParticipant&gt; findByRegattaIdAndBoatId(Long regattaId, Long boatId);&#10;&#10;    @Query(&quot;SELECT p FROM RegattaParticipant p WHERE p.regatta.id = :regattaId ORDER BY p.totalPoints ASC&quot;)&#10;    List&lt;RegattaParticipant&gt; findByRegattaIdOrderByTotalPoints(@Param(&quot;regattaId&quot;) Long regattaId);&#10;&#10;    long countByRegattaId(Long regattaId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RegattaRepository.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Repository/RegattaRepository.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Repository;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;import org.springframework.data.jpa.repository.JpaRepository;&#10;import org.springframework.stereotype.Repository;&#10;&#10;import java.time.LocalDate;&#10;import java.util.List;&#10;&#10;@Repository&#10;public interface RegattaRepository extends JpaRepository&lt;Regatta, Long&gt; {&#10;&#10;    List&lt;Regatta&gt; findByStatus(String status);&#10;&#10;    List&lt;Regatta&gt; findByEventDateAfterOrderByEventDateAsc(LocalDate date);&#10;&#10;    List&lt;Regatta&gt; findByEventDateBetween(LocalDate start, LocalDate end);&#10;&#10;    List&lt;Regatta&gt; findByCreatedBy(Long userId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/JwtAuthenticationFilter.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/JwtAuthenticationFilter.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Security;&#10;&#10;import jakarta.servlet.FilterChain;&#10;import jakarta.servlet.ServletException;&#10;import jakarta.servlet.http.HttpServletRequest;&#10;import jakarta.servlet.http.HttpServletResponse;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;&#10;import org.springframework.security.core.authority.SimpleGrantedAuthority;&#10;import org.springframework.security.core.context.SecurityContextHolder;&#10;import org.springframework.stereotype.Component;&#10;import org.springframework.web.filter.OncePerRequestFilter;&#10;&#10;import java.io.IOException;&#10;import java.util.List;&#10;import java.util.stream.Collectors;&#10;&#10;@Component&#10;@RequiredArgsConstructor&#10;public class JwtAuthenticationFilter extends OncePerRequestFilter {&#10;&#10;    private final JwtService jwtService;&#10;&#10;    @Override&#10;    protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response,&#10;                                    FilterChain filterChain) throws ServletException, IOException {&#10;        &#10;        final String authHeader = request.getHeader(&quot;Authorization&quot;);&#10;&#10;        if (authHeader == null || !authHeader.startsWith(&quot;Bearer &quot;)) {&#10;            filterChain.doFilter(request, response);&#10;            return;&#10;        }&#10;&#10;        try {&#10;            final String jwt = authHeader.substring(7);&#10;            final String username = jwtService.extractUsername(jwt);&#10;&#10;            if (username != null &amp;&amp; SecurityContextHolder.getContext().getAuthentication() == null) {&#10;                if (jwtService.isTokenValid(jwt)) {&#10;                    List&lt;String&gt; roles = jwtService.extractRoles(jwt);&#10;                    &#10;                    List&lt;SimpleGrantedAuthority&gt; authorities = roles.stream()&#10;                            .map(role -&gt; new SimpleGrantedAuthority(role.startsWith(&quot;ROLE_&quot;) ? role : &quot;ROLE_&quot; + role))&#10;                            .collect(Collectors.toList());&#10;&#10;                    UsernamePasswordAuthenticationToken authToken =&#10;                            new UsernamePasswordAuthenticationToken(username, null, authorities);&#10;&#10;                    SecurityContextHolder.getContext().setAuthentication(authToken);&#10;                }&#10;            }&#10;        } catch (Exception e) {&#10;            logger.error(&quot;Error validating JWT token&quot;, e);&#10;        }&#10;&#10;        filterChain.doFilter(request, response);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/JwtService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/JwtService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Security;&#10;&#10;import io.jsonwebtoken.Claims;&#10;import io.jsonwebtoken.Jwts;&#10;import io.jsonwebtoken.security.Keys;&#10;import org.springframework.beans.factory.annotation.Value;&#10;import org.springframework.stereotype.Component;&#10;&#10;import javax.crypto.SecretKey;&#10;import java.nio.charset.StandardCharsets;&#10;import java.util.Date;&#10;import java.util.List;&#10;import java.util.function.Function;&#10;&#10;@Component&#10;public class JwtService {&#10;&#10;    @Value(&quot;${jwt.secret}&quot;)&#10;    private String secretKey;&#10;&#10;    public String extractUsername(String token) {&#10;        return extractClaim(token, Claims::getSubject);&#10;    }&#10;&#10;    public Date extractExpiration(String token) {&#10;        return extractClaim(token, Claims::getExpiration);&#10;    }&#10;&#10;    @SuppressWarnings(&quot;unchecked&quot;)&#10;    public List&lt;String&gt; extractRoles(String token) {&#10;        return extractClaim(token, claims -&gt; claims.get(&quot;roles&quot;, List.class));&#10;    }&#10;&#10;    public &lt;T&gt; T extractClaim(String token, Function&lt;Claims, T&gt; claimsResolver) {&#10;        final Claims claims = extractAllClaims(token);&#10;        return claimsResolver.apply(claims);&#10;    }&#10;&#10;    private Claims extractAllClaims(String token) {&#10;        return Jwts.parser()&#10;                .verifyWith(getSigningKey())&#10;                .build()&#10;                .parseSignedClaims(token)&#10;                .getPayload();&#10;    }&#10;&#10;    private SecretKey getSigningKey() {&#10;        byte[] keyBytes = secretKey.getBytes(StandardCharsets.UTF_8);&#10;        return Keys.hmacShaKeyFor(keyBytes);&#10;    }&#10;&#10;    public boolean isTokenValid(String token) {&#10;        return !isTokenExpired(token);&#10;    }&#10;&#10;    private boolean isTokenExpired(String token) {&#10;        return extractExpiration(token).before(new Date());&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/SecurityConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Security/SecurityConfig.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Security;&#10;&#10;import lombok.RequiredArgsConstructor;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.security.config.annotation.method.configuration.EnableMethodSecurity;&#10;import org.springframework.security.config.annotation.web.builders.HttpSecurity;&#10;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;&#10;import org.springframework.security.config.annotation.web.configurers.AbstractHttpConfigurer;&#10;import org.springframework.security.config.http.SessionCreationPolicy;&#10;import org.springframework.security.web.SecurityFilterChain;&#10;import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;&#10;&#10;@Configuration&#10;@EnableWebSecurity&#10;@EnableMethodSecurity&#10;@RequiredArgsConstructor&#10;public class SecurityConfig {&#10;&#10;    private final JwtAuthenticationFilter jwtAuthFilter;&#10;&#10;    @Bean&#10;    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {&#10;        http&#10;            .csrf(AbstractHttpConfigurer::disable)&#10;            .sessionManagement(session -&gt; session.sessionCreationPolicy(SessionCreationPolicy.STATELESS))&#10;            .authorizeHttpRequests(auth -&gt; auth&#10;                    // Endpoints públicos&#10;                    .requestMatchers(&quot;/api/regattas&quot;, &quot;/api/regattas/upcoming&quot;).permitAll()&#10;                    .requestMatchers(&quot;/api/boats/**&quot;).permitAll()&#10;                    .requestMatchers(&quot;/api/participants/regatta/**&quot;).permitAll()&#10;                    // El resto requiere autenticación&#10;                    .anyRequest().authenticated()&#10;            )&#10;            .addFilterBefore(jwtAuthFilter, UsernamePasswordAuthenticationFilter.class);&#10;&#10;        return http.build();&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/BoatServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/BoatServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Boat;&#10;import com.evs.MicroserviceRegattaApi.Repository.BoatRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IBoatService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.List;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class BoatServiceImpl implements IBoatService {&#10;&#10;    private final BoatRepository boatRepository;&#10;&#10;    @Override&#10;    @Transactional&#10;    public Boat create(Boat boat) {&#10;        if (boatRepository.existsBySailNumber(boat.getSailNumber())) {&#10;            throw new RuntimeException(&quot;Ya existe un barco con número de vela: &quot; + boat.getSailNumber());&#10;        }&#10;        Boat saved = boatRepository.save(boat);&#10;        log.info(&quot;Barco registrado: {} - {}&quot;, saved.getSailNumber(), saved.getName());&#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Boat update(Long id, Boat boat) {&#10;        Boat existing = findById(id);&#10;        existing.setName(boat.getName());&#10;        existing.setBoatClass(boat.getBoatClass());&#10;        existing.setLength(boat.getLength());&#10;        existing.setBeam(boat.getBeam());&#10;        existing.setSailArea(boat.getSailArea());&#10;        existing.setAutoRating(boat.getAutoRating());&#10;        if (!boat.getAutoRating()) {&#10;            existing.setRating(boat.getRating());&#10;        }&#10;        existing.setNotes(boat.getNotes());&#10;        return boatRepository.save(existing);&#10;    }&#10;&#10;    @Override&#10;    public Boat findById(Long id) {&#10;        return boatRepository.findById(id)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Barco no encontrado: &quot; + id));&#10;    }&#10;&#10;    @Override&#10;    public Boat findBySailNumber(String sailNumber) {&#10;        return boatRepository.findBySailNumber(sailNumber)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Barco no encontrado: &quot; + sailNumber));&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Boat&gt; findAll() {&#10;        return boatRepository.findAll();&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Boat&gt; findByOwner(Long ownerId) {&#10;        return boatRepository.findByOwnerId(ownerId);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Boat&gt; findByClass(String boatClass) {&#10;        return boatRepository.findByBoatClass(boatClass);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void delete(Long id) {&#10;        boatRepository.deleteById(id);&#10;        log.info(&quot;Barco eliminado: {}&quot;, id);&#10;    }&#10;&#10;    @Override&#10;    public boolean existsBySailNumber(String sailNumber) {&#10;        return boatRepository.existsBySailNumber(sailNumber);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/ClassificationServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/ClassificationServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RaceResult;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;import com.evs.MicroserviceRegattaApi.Repository.RaceResultRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IClassificationService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IParticipantService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRaceResultService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.Comparator;&#10;import java.util.List;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class ClassificationServiceImpl implements IClassificationService {&#10;&#10;    private final RaceResultRepository resultRepository;&#10;    private final IParticipantService participantService;&#10;&#10;    @Override&#10;    @Transactional&#10;    public void calculateRacePositions(Long raceId) {&#10;        List&lt;RaceResult&gt; results = resultRepository.findByRaceIdOrderByCorrectedTime(raceId);&#10;        int position = 1;&#10;        int totalParticipants = results.size();&#10;&#10;        for (RaceResult result : results) {&#10;            if (&quot;FINISH&quot;.equals(result.getStatus())) {&#10;                result.setPosition(position++);&#10;            }&#10;            result.assignPoints(totalParticipants);&#10;            resultRepository.save(result);&#10;        }&#10;        &#10;        log.info(&quot;Posiciones calculadas para manga {} - {} participantes&quot;, raceId, totalParticipants);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void updateTotalPoints(Long regattaId) {&#10;        List&lt;RegattaParticipant&gt; participants = participantService.findByRegatta(regattaId);&#10;        &#10;        for (RegattaParticipant participant : participants) {&#10;            Integer totalPoints = resultRepository.sumPointsByParticipant(participant.getId());&#10;            participantService.updateTotalPoints(participant.getId(), totalPoints != null ? totalPoints : 0);&#10;        }&#10;        &#10;        log.info(&quot;Puntos totales actualizados para regata {}&quot;, regattaId);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void calculateFinalClassification(Long regattaId) {&#10;        List&lt;RegattaParticipant&gt; participants = participantService.getClassification(regattaId);&#10;        &#10;        int position = 1;&#10;        for (RegattaParticipant participant : participants) {&#10;            if (!&quot;RETIRADO&quot;.equals(participant.getStatus()) &amp;&amp; !&quot;DESCALIFICADO&quot;.equals(participant.getStatus())) {&#10;                participantService.setFinalPosition(participant.getId(), position++);&#10;            }&#10;        }&#10;&#10;        log.info(&quot;Clasificación final calculada para regata {} - {} clasificados&quot;, regattaId, position - 1);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void applyDiscards(Long regattaId, int numberOfDiscards) {&#10;        List&lt;RegattaParticipant&gt; participants = participantService.findByRegatta(regattaId);&#10;        &#10;        for (RegattaParticipant participant : participants) {&#10;            List&lt;RaceResult&gt; results = resultRepository.findByParticipantId(participant.getId());&#10;            &#10;            if (results.size() &gt; numberOfDiscards) {&#10;                // Ordenar por puntos descendente para descartar los peores&#10;                results.sort(Comparator.comparingInt(RaceResult::getPoints).reversed());&#10;                &#10;                int totalPoints = 0;&#10;                int count = 0;&#10;                for (RaceResult result : results) {&#10;                    if (count &lt; results.size() - numberOfDiscards) {&#10;                        totalPoints += result.getPoints();&#10;                    }&#10;                    count++;&#10;                }&#10;                &#10;                participantService.updateTotalPoints(participant.getId(), totalPoints);&#10;            }&#10;        }&#10;        &#10;        log.info(&quot;Descartes aplicados a regata {}: {} mangas descartadas&quot;, regattaId, numberOfDiscards);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/ParticipantServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/ParticipantServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Boat;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;import com.evs.MicroserviceRegattaApi.Repository.RegattaParticipantRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IBoatService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IParticipantService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRegattaService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.context.annotation.Lazy;&#10;import org.springframework.kafka.core.KafkaTemplate;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.ArrayList;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class ParticipantServiceImpl implements IParticipantService {&#10;&#10;    private final RegattaParticipantRepository participantRepository;&#10;    private final IBoatService boatService;&#10;    private final KafkaTemplate&lt;String, Object&gt; kafkaTemplate;&#10;    &#10;    @Lazy&#10;    private final IRegattaService regattaService;&#10;&#10;    @Override&#10;    @Transactional&#10;    public RegattaParticipant register(Long regattaId, Long boatId, Long skipperId,&#10;                                        List&lt;Long&gt; crewIds, List&lt;String&gt; crewNames) {&#10;        Regatta regatta = regattaService.findById(regattaId);&#10;        &#10;        if (!&quot;INSCRIPCIONES_ABIERTAS&quot;.equals(regatta.getStatus())) {&#10;            throw new RuntimeException(&quot;Las inscripciones no están abiertas&quot;);&#10;        }&#10;&#10;        if (regatta.getMaxParticipants() != null) {&#10;            long currentCount = participantRepository.countByRegattaId(regattaId);&#10;            if (currentCount &gt;= regatta.getMaxParticipants()) {&#10;                throw new RuntimeException(&quot;Se ha alcanzado el máximo de participantes&quot;);&#10;            }&#10;        }&#10;&#10;        if (participantRepository.findByRegattaIdAndBoatId(regattaId, boatId).isPresent()) {&#10;            throw new RuntimeException(&quot;Este barco ya está inscrito en la regata&quot;);&#10;        }&#10;&#10;        Boat boat = boatService.findById(boatId);&#10;&#10;        RegattaParticipant participant = RegattaParticipant.builder()&#10;                .regatta(regatta)&#10;                .boat(boat)&#10;                .skipperId(skipperId)&#10;                .crewIds(crewIds != null ? crewIds : new ArrayList&lt;&gt;())&#10;                .crewNames(crewNames != null ? crewNames : new ArrayList&lt;&gt;())&#10;                .registrationDate(LocalDateTime.now())&#10;                .status(&quot;INSCRITO&quot;)&#10;                .feePaid(false)&#10;                .totalPoints(0)&#10;                .build();&#10;&#10;        RegattaParticipant saved = participantRepository.save(participant);&#10;        log.info(&quot;Participante inscrito en regata {}: barco {} patrón {}&quot;, regattaId, boatId, skipperId);&#10;&#10;        if (regatta.getRegistrationFee() != null &amp;&amp; regatta.getRegistrationFee() &gt; 0) {&#10;            kafkaTemplate.send(&quot;regatta-registration-events&quot;, &quot;registration-created&quot;, Map.of(&#10;                    &quot;regattaId&quot;, regattaId,&#10;                    &quot;participantId&quot;, saved.getId(),&#10;                    &quot;skipperId&quot;, skipperId,&#10;                    &quot;fee&quot;, regatta.getRegistrationFee()&#10;            ));&#10;        }&#10;&#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RegattaParticipant confirm(Long participantId) {&#10;        RegattaParticipant participant = findById(participantId);&#10;        participant.setStatus(&quot;CONFIRMADO&quot;);&#10;        participant.setFeePaid(true);&#10;        log.info(&quot;Participante confirmado: {}&quot;, participantId);&#10;        return participantRepository.save(participant);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RegattaParticipant withdraw(Long participantId) {&#10;        RegattaParticipant participant = findById(participantId);&#10;        participant.setStatus(&quot;RETIRADO&quot;);&#10;        log.info(&quot;Participante retirado: {}&quot;, participantId);&#10;        return participantRepository.save(participant);&#10;    }&#10;&#10;    @Override&#10;    public RegattaParticipant findById(Long id) {&#10;        return participantRepository.findById(id)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Participante no encontrado: &quot; + id));&#10;    }&#10;&#10;    @Override&#10;    public List&lt;RegattaParticipant&gt; findByRegatta(Long regattaId) {&#10;        return participantRepository.findByRegattaId(regattaId);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;RegattaParticipant&gt; findBySkipper(Long skipperId) {&#10;        return participantRepository.findBySkipperId(skipperId);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;RegattaParticipant&gt; getClassification(Long regattaId) {&#10;        return participantRepository.findByRegattaIdOrderByTotalPoints(regattaId);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void updateTotalPoints(Long participantId, Integer points) {&#10;        RegattaParticipant participant = findById(participantId);&#10;        participant.setTotalPoints(points);&#10;        participantRepository.save(participant);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void setFinalPosition(Long participantId, Integer position) {&#10;        RegattaParticipant participant = findById(participantId);&#10;        participant.setFinalPosition(position);&#10;        participantRepository.save(participant);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RaceResultServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RaceResultServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Race;&#10;import com.evs.MicroserviceRegattaApi.Entities.RaceResult;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;import com.evs.MicroserviceRegattaApi.Repository.RaceRepository;&#10;import com.evs.MicroserviceRegattaApi.Repository.RaceResultRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IParticipantService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRaceResultService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.List;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class RaceResultServiceImpl implements IRaceResultService {&#10;&#10;    private final RaceResultRepository resultRepository;&#10;    private final RaceRepository raceRepository;&#10;    private final IParticipantService participantService;&#10;&#10;    @Override&#10;    @Transactional&#10;    public RaceResult recordFinish(Long raceId, Long participantId, Long elapsedSeconds) {&#10;        Race race = findRace(raceId);&#10;        RegattaParticipant participant = participantService.findById(participantId);&#10;&#10;        RaceResult result = RaceResult.builder()&#10;                .race(race)&#10;                .participant(participant)&#10;                .elapsedSeconds(elapsedSeconds)&#10;                .status(&quot;FINISH&quot;)&#10;                .penaltyPoints(0)&#10;                .build();&#10;&#10;        result.calculateCorrectedTime(participant.getBoat().getRating());&#10;&#10;        RaceResult saved = resultRepository.save(result);&#10;        log.info(&quot;Llegada registrada: Participante {} en manga {} - {} segundos&quot;, &#10;                participantId, raceId, elapsedSeconds);&#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RaceResult recordDNF(Long raceId, Long participantId, String reason) {&#10;        return recordNonFinish(raceId, participantId, &quot;DNF&quot;, reason);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RaceResult recordDNS(Long raceId, Long participantId, String reason) {&#10;        return recordNonFinish(raceId, participantId, &quot;DNS&quot;, reason);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RaceResult recordDSQ(Long raceId, Long participantId, String reason) {&#10;        return recordNonFinish(raceId, participantId, &quot;DSQ&quot;, reason);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public RaceResult recordOCS(Long raceId, Long participantId) {&#10;        return recordNonFinish(raceId, participantId, &quot;OCS&quot;, &quot;On Course Side - Salida anticipada&quot;);&#10;    }&#10;&#10;    private RaceResult recordNonFinish(Long raceId, Long participantId, String status, String reason) {&#10;        Race race = findRace(raceId);&#10;        RegattaParticipant participant = participantService.findById(participantId);&#10;&#10;        RaceResult result = RaceResult.builder()&#10;                .race(race)&#10;                .participant(participant)&#10;                .status(status)&#10;                .notes(reason)&#10;                .penaltyPoints(0)&#10;                .build();&#10;&#10;        RaceResult saved = resultRepository.save(result);&#10;        log.info(&quot;{} registrado: Participante {} en manga {} - {}&quot;, status, participantId, raceId, reason);&#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    public RaceResult findById(Long id) {&#10;        return resultRepository.findById(id)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Resultado no encontrado: &quot; + id));&#10;    }&#10;&#10;    @Override&#10;    public List&lt;RaceResult&gt; findByRace(Long raceId) {&#10;        return resultRepository.findByRaceIdOrderByPositionAsc(raceId);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;RaceResult&gt; findByParticipant(Long participantId) {&#10;        return resultRepository.findByParticipantId(participantId);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void calculatePositions(Long raceId) {&#10;        List&lt;RaceResult&gt; results = resultRepository.findByRaceIdOrderByCorrectedTime(raceId);&#10;        int position = 1;&#10;        int totalParticipants = results.size();&#10;&#10;        for (RaceResult result : results) {&#10;            if (&quot;FINISH&quot;.equals(result.getStatus())) {&#10;                result.setPosition(position++);&#10;            }&#10;            result.assignPoints(totalParticipants);&#10;            resultRepository.save(result);&#10;        }&#10;        &#10;        log.info(&quot;Posiciones calculadas para manga {}&quot;, raceId);&#10;    }&#10;&#10;    private Race findRace(Long raceId) {&#10;        return raceRepository.findById(raceId)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Manga no encontrada: &quot; + raceId));&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RaceServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RaceServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Race;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;import com.evs.MicroserviceRegattaApi.Repository.RaceRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IClassificationService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRaceService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRegattaService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.context.annotation.Lazy;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.time.LocalDateTime;&#10;import java.util.List;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class RaceServiceImpl implements IRaceService {&#10;&#10;    private final RaceRepository raceRepository;&#10;    private final IClassificationService classificationService;&#10;    &#10;    @Lazy&#10;    private final IRegattaService regattaService;&#10;&#10;    @Override&#10;    @Transactional&#10;    public Race create(Long regattaId, Integer raceNumber) {&#10;        Regatta regatta = regattaService.findById(regattaId);&#10;        &#10;        Race race = Race.builder()&#10;                .regatta(regatta)&#10;                .raceNumber(raceNumber)&#10;                .status(&quot;PLANIFICADA&quot;)&#10;                .numberOfLaps(1)&#10;                .build();&#10;&#10;        Race saved = raceRepository.save(race);&#10;        log.info(&quot;Manga {} creada para regata {}&quot;, raceNumber, regattaId);&#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Race start(Long raceId, Integer windDirection, Double windSpeed) {&#10;        Race race = findById(raceId);&#10;        race.setStartTime(LocalDateTime.now());&#10;        race.setWindDirection(windDirection);&#10;        race.setWindSpeed(windSpeed);&#10;        race.setStatus(&quot;EN_CURSO&quot;);&#10;        log.info(&quot;Manga {} iniciada. Viento: {}° a {} kts&quot;, raceId, windDirection, windSpeed);&#10;        return raceRepository.save(race);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Race finish(Long raceId) {&#10;        Race race = findById(raceId);&#10;        &#10;        // Calcular posiciones&#10;        classificationService.calculateRacePositions(raceId);&#10;        &#10;        // Actualizar puntos totales&#10;        classificationService.updateTotalPoints(race.getRegatta().getId());&#10;&#10;        race.setStatus(&quot;FINALIZADA&quot;);&#10;        log.info(&quot;Manga {} finalizada&quot;, raceId);&#10;        return raceRepository.save(race);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Race abandon(Long raceId, String reason) {&#10;        Race race = findById(raceId);&#10;        race.setStatus(&quot;ABANDONADA&quot;);&#10;        race.setNotes(reason);&#10;        log.info(&quot;Manga {} abandonada: {}&quot;, raceId, reason);&#10;        return raceRepository.save(race);&#10;    }&#10;&#10;    @Override&#10;    public Race findById(Long id) {&#10;        return raceRepository.findById(id)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Manga no encontrada: &quot; + id));&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Race&gt; findByRegatta(Long regattaId) {&#10;        return raceRepository.findByRegattaIdOrderByRaceNumberAsc(regattaId);&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Race&gt; findByRegattaAndStatus(Long regattaId, String status) {&#10;        return raceRepository.findByRegattaIdAndStatus(regattaId, status);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RegattaServiceImpl.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Impl/RegattaServiceImpl.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Impl;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;import com.evs.MicroserviceRegattaApi.Repository.RegattaRepository;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IClassificationService;&#10;import com.evs.MicroserviceRegattaApi.Service.Inter.IRegattaService;&#10;import lombok.RequiredArgsConstructor;&#10;import lombok.extern.slf4j.Slf4j;&#10;import org.springframework.kafka.core.KafkaTemplate;&#10;import org.springframework.stereotype.Service;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.time.LocalDate;&#10;import java.time.LocalDateTime;&#10;import java.util.List;&#10;import java.util.Map;&#10;&#10;@Slf4j&#10;@Service&#10;@RequiredArgsConstructor&#10;public class RegattaServiceImpl implements IRegattaService {&#10;&#10;    private final RegattaRepository regattaRepository;&#10;    private final IClassificationService classificationService;&#10;    private final KafkaTemplate&lt;String, Object&gt; kafkaTemplate;&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta create(Regatta regatta, Long createdBy) {&#10;        regatta.setCreatedBy(createdBy);&#10;        regatta.setCreatedAt(LocalDateTime.now());&#10;        regatta.setStatus(&quot;PLANIFICADA&quot;);&#10;        &#10;        Regatta saved = regattaRepository.save(regatta);&#10;        log.info(&quot;Regata creada: {} por usuario {}&quot;, saved.getId(), createdBy);&#10;        &#10;        kafkaTemplate.send(&quot;regatta-events&quot;, &quot;regatta-created&quot;, Map.of(&#10;                &quot;regattaId&quot;, saved.getId(),&#10;                &quot;name&quot;, saved.getName(),&#10;                &quot;date&quot;, saved.getEventDate().toString()&#10;        ));&#10;        &#10;        return saved;&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta update(Long id, Regatta regatta) {&#10;        Regatta existing = findById(id);&#10;        existing.setName(regatta.getName());&#10;        existing.setDescription(regatta.getDescription());&#10;        existing.setEventDate(regatta.getEventDate());&#10;        existing.setRegistrationDeadline(regatta.getRegistrationDeadline());&#10;        existing.setLocation(regatta.getLocation());&#10;        existing.setMaxParticipants(regatta.getMaxParticipants());&#10;        existing.setRegistrationFee(regatta.getRegistrationFee());&#10;        existing.setPlannedRaces(regatta.getPlannedRaces());&#10;        existing.setNotes(regatta.getNotes());&#10;        return regattaRepository.save(existing);&#10;    }&#10;&#10;    @Override&#10;    public Regatta findById(Long id) {&#10;        return regattaRepository.findById(id)&#10;                .orElseThrow(() -&gt; new RuntimeException(&quot;Regata no encontrada: &quot; + id));&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Regatta&gt; findAll() {&#10;        return regattaRepository.findAll();&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Regatta&gt; findUpcoming() {&#10;        return regattaRepository.findByEventDateAfterOrderByEventDateAsc(LocalDate.now());&#10;    }&#10;&#10;    @Override&#10;    public List&lt;Regatta&gt; findByStatus(String status) {&#10;        return regattaRepository.findByStatus(status);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public void delete(Long id) {&#10;        Regatta regatta = findById(id);&#10;        if (!&quot;PLANIFICADA&quot;.equals(regatta.getStatus())) {&#10;            throw new RuntimeException(&quot;Solo se pueden eliminar regatas planificadas&quot;);&#10;        }&#10;        regattaRepository.deleteById(id);&#10;        log.info(&quot;Regata eliminada: {}&quot;, id);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta openRegistrations(Long regattaId) {&#10;        Regatta regatta = findById(regattaId);&#10;        regatta.setStatus(&quot;INSCRIPCIONES_ABIERTAS&quot;);&#10;        log.info(&quot;Inscripciones abiertas para regata: {}&quot;, regattaId);&#10;        return regattaRepository.save(regatta);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta closeRegistrations(Long regattaId) {&#10;        Regatta regatta = findById(regattaId);&#10;        regatta.setStatus(&quot;INSCRIPCIONES_CERRADAS&quot;);&#10;        log.info(&quot;Inscripciones cerradas para regata: {}&quot;, regattaId);&#10;        return regattaRepository.save(regatta);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta start(Long regattaId) {&#10;        Regatta regatta = findById(regattaId);&#10;        regatta.setStatus(&quot;EN_CURSO&quot;);&#10;        log.info(&quot;Regata iniciada: {}&quot;, regattaId);&#10;        return regattaRepository.save(regatta);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta finish(Long regattaId) {&#10;        Regatta regatta = findById(regattaId);&#10;        classificationService.calculateFinalClassification(regattaId);&#10;        regatta.setStatus(&quot;FINALIZADA&quot;);&#10;        log.info(&quot;Regata finalizada: {}&quot;, regattaId);&#10;        return regattaRepository.save(regatta);&#10;    }&#10;&#10;    @Override&#10;    @Transactional&#10;    public Regatta assignStaff(Long regattaId, List&lt;Long&gt; staffIds) {&#10;        Regatta regatta = findById(regattaId);&#10;        regatta.setStaffIds(staffIds);&#10;        log.info(&quot;Personal asignado a regata {}: {} personas&quot;, regattaId, staffIds.size());&#10;        return regattaRepository.save(regatta);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IBoatService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IBoatService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Boat;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * Interfaz para la gestión de barcos (Single Responsibility)&#10; */&#10;public interface IBoatService {&#10;&#10;    Boat create(Boat boat);&#10;&#10;    Boat update(Long id, Boat boat);&#10;&#10;    Boat findById(Long id);&#10;&#10;    Boat findBySailNumber(String sailNumber);&#10;&#10;    List&lt;Boat&gt; findAll();&#10;&#10;    List&lt;Boat&gt; findByOwner(Long ownerId);&#10;&#10;    List&lt;Boat&gt; findByClass(String boatClass);&#10;&#10;    void delete(Long id);&#10;&#10;    boolean existsBySailNumber(String sailNumber);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IClassificationService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IClassificationService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;/**&#10; * Interfaz para el cálculo de clasificaciones (Single Responsibility)&#10; */&#10;public interface IClassificationService {&#10;&#10;    /**&#10;     * Calcula las posiciones tras finalizar una manga&#10;     */&#10;    void calculateRacePositions(Long raceId);&#10;&#10;    /**&#10;     * Actualiza los puntos totales de todos los participantes de una regata&#10;     */&#10;    void updateTotalPoints(Long regattaId);&#10;&#10;    /**&#10;     * Calcula la clasificación final de la regata&#10;     */&#10;    void calculateFinalClassification(Long regattaId);&#10;&#10;    /**&#10;     * Aplica descarte si hay suficientes mangas&#10;     */&#10;    void applyDiscards(Long regattaId, int numberOfDiscards);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IParticipantService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IParticipantService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RegattaParticipant;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * Interfaz para la gestión de participantes en regatas (Single Responsibility)&#10; */&#10;public interface IParticipantService {&#10;&#10;    RegattaParticipant register(Long regattaId, Long boatId, Long skipperId,&#10;                                 List&lt;Long&gt; crewIds, List&lt;String&gt; crewNames);&#10;&#10;    RegattaParticipant confirm(Long participantId);&#10;&#10;    RegattaParticipant withdraw(Long participantId);&#10;&#10;    RegattaParticipant findById(Long id);&#10;&#10;    List&lt;RegattaParticipant&gt; findByRegatta(Long regattaId);&#10;&#10;    List&lt;RegattaParticipant&gt; findBySkipper(Long skipperId);&#10;&#10;    List&lt;RegattaParticipant&gt; getClassification(Long regattaId);&#10;&#10;    void updateTotalPoints(Long participantId, Integer points);&#10;&#10;    void setFinalPosition(Long participantId, Integer position);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRaceResultService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRaceResultService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.RaceResult;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * Interfaz para la gestión de resultados de mangas (Single Responsibility)&#10; */&#10;public interface IRaceResultService {&#10;&#10;    RaceResult recordFinish(Long raceId, Long participantId, Long elapsedSeconds);&#10;&#10;    RaceResult recordDNF(Long raceId, Long participantId, String reason);&#10;&#10;    RaceResult recordDNS(Long raceId, Long participantId, String reason);&#10;&#10;    RaceResult recordDSQ(Long raceId, Long participantId, String reason);&#10;&#10;    RaceResult recordOCS(Long raceId, Long participantId);&#10;&#10;    RaceResult findById(Long id);&#10;&#10;    List&lt;RaceResult&gt; findByRace(Long raceId);&#10;&#10;    List&lt;RaceResult&gt; findByParticipant(Long participantId);&#10;&#10;    void calculatePositions(Long raceId);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRaceService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRaceService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Race;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * Interfaz para la gestión de mangas (Single Responsibility)&#10; */&#10;public interface IRaceService {&#10;&#10;    Race create(Long regattaId, Integer raceNumber);&#10;&#10;    Race start(Long raceId, Integer windDirection, Double windSpeed);&#10;&#10;    Race finish(Long raceId);&#10;&#10;    Race abandon(Long raceId, String reason);&#10;&#10;    Race findById(Long id);&#10;&#10;    List&lt;Race&gt; findByRegatta(Long regattaId);&#10;&#10;    List&lt;Race&gt; findByRegattaAndStatus(Long regattaId, String status);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRegattaService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/java/com/evs/MicroserviceRegattaApi/Service/Inter/IRegattaService.java" />
              <option name="updatedContent" value="package com.evs.MicroserviceRegattaApi.Service.Inter;&#10;&#10;import com.evs.MicroserviceRegattaApi.Entities.Regatta;&#10;&#10;import java.util.List;&#10;&#10;/**&#10; * Interfaz para la gestión de regatas (Single Responsibility)&#10; */&#10;public interface IRegattaService {&#10;&#10;    Regatta create(Regatta regatta, Long createdBy);&#10;&#10;    Regatta update(Long id, Regatta regatta);&#10;&#10;    Regatta findById(Long id);&#10;&#10;    List&lt;Regatta&gt; findAll();&#10;&#10;    List&lt;Regatta&gt; findUpcoming();&#10;&#10;    List&lt;Regatta&gt; findByStatus(String status);&#10;&#10;    void delete(Long id);&#10;&#10;    Regatta openRegistrations(Long regattaId);&#10;&#10;    Regatta closeRegistrations(Long regattaId);&#10;&#10;    Regatta start(Long regattaId);&#10;&#10;    Regatta finish(Long regattaId);&#10;&#10;    Regatta assignStaff(Long regattaId, List&lt;Long&gt; staffIds);&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/resources/application.yml">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/MicroserviceRegattaApi/src/main/resources/application.yml" />
              <option name="updatedContent" value="server:&#10;  port: 8085&#10;&#10;spring:&#10;  application:&#10;    name: msvc-regatta&#10;  datasource:&#10;    driver-class-name: org.postgresql.Driver&#10;    url: jdbc:postgresql://localhost:5432/tfgdb&#10;    username: postgres&#10;    password: curso&#10;  jpa:&#10;    hibernate:&#10;      ddl-auto: update&#10;    show-sql: true&#10;    database: postgresql&#10;    database-platform: org.hibernate.dialect.PostgreSQLDialect&#10;  kafka:&#10;    bootstrap-servers: localhost:29092&#10;    consumer:&#10;      group-id: regatta-group&#10;      auto-offset-reset: earliest&#10;      key-deserializer: org.apache.kafka.common.serialization.StringDeserializer&#10;      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer&#10;      properties:&#10;        spring.json.trusted.packages: &quot;*&quot;&#10;    producer:&#10;      key-serializer: org.apache.kafka.common.serialization.StringSerializer&#10;      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer&#10;&#10;jwt:&#10;  secret: RVZTX0xhQW50aWxsYV9TZWNyZXRLZXlfMjAyNF9URkdfU2FpbGluZ1NjaG9vbF9KV1RfVG9rZW5fS2V5&#10;  expiration: 86400000&#10;&#10;eureka:&#10;  instance:&#10;    hostname: localhost&#10;  client:&#10;    service-url:&#10;      defaultZone: http://localhost:8761/eureka/&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>